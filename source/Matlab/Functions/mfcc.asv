function MFCCs = mfcc(x,f_s,K)
    n_fft = length(x);
    filter_max = 2;
    x = lowpass(x,.9*f_s/2, f_s);
    X = fft(x,n_fft).*hamming(n_fft)';
    X = X(1:(n_fft/2+1));
    filter_banks = melBanks(K,f_s,n_fft,0,f_s/2,filter_max);
    Y = zeros(K,n_fft/2);
    for i = 1:K
        Y(i,:) = X.*filter_banks(i,:);
    end
    S_log =log(sum(abs(Y).^2,2))'; % take the log of the sum of the power spectral density banks
    MFCCs = dct(S_log,K); 
end